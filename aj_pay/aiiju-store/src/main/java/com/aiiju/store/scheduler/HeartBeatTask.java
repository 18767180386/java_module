package com.aiiju.store.scheduler;

import java.text.ParseException;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;

import org.springframework.beans.factory.annotation.Autowired;

import com.aiiju.dao.JedisClient;
import com.aiiju.pojo.UserLoginRecord;
import com.aiiju.store.service.UserService;

/**
 * 
 * @ClassName: HeartBeatTask
 * @Description: 用户在线心跳
 * @author 宗介
 * @date 2017年6月9日 
 */
public class HeartBeatTask  {

//    @Autowired
//    private JedisClient jedisClient;
//	@Autowired
//	private UserService userService;

public void checkOnLineStatus() throws ParseException{
//    List<UserLoginRecord> taskList = new ArrayList<UserLoginRecord>();
   
    
//    System.out.println(jedisClient);
    
//   Set<String> total =  jedisClient.keys("HEART_BEAT:*");
 
    
  //  List<UserLoginRecord> onlineList = this.userService.getOnlineUserList();
 //   UserLoginRecord ulr = new UserLoginRecord();

//    System.out.println("检测用户在线定时器 开始执行，当前在线人数："+total.size());

//    StringBuffer sb= new StringBuffer();
//    for (String userkey : total) {
//    	
//    	String userId = userkey.replace("HEART_BEAT:", "");
//    	sb.append(userId+",");
//	}
    
   // System.out.println("当前在线用户为："+sb.toString());
    
//    for (UserLoginRecord online : onlineList) {
//
//    	System.out.println(online);
//    	
//    	String userId= this.jedisClient.get("HEART_BEAT" + ":" + online.getId());
//
//    	if(userId==null){
//    		
//    		System.out.println("检测到用户："+online.getUserId()+" 下线了");
//    		ulr.setUserId(online.getUserId());
//    		ulr.setCurrentStatus("0");
//    		ulr.setLogoutTime(new Date());
//    	//	ulr.setOnlineTime(onlineTime);
//    		taskList.add(ulr);
//    		// 更新为下线
//    	}
//    	
// 
//    }
    

	
	
//    if (taskList.size() > 0) {
//
//      //  this.userService.updateStatusBatch(taskList);
//        taskList = null;
//    }
}
}
